<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø³Ø¨Ø§Ù‚</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="site-nav">
        <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a href="join.html">Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±ÙŠÙ‚</a>
        <a href="board.html">Ù„ÙˆØ­Ø© Ø§Ù„Ø³Ø¨Ø§Ù‚</a>
    </nav>
    <h1 id="mainTitle" style="color:white; margin-top:10px;">ğŸ Ø³Ø¨Ø§Ù‚ Ø§Ù„ÙØ±Ù‚</h1>

    <div id="board"></div>

    <div class="controls-container">
        <button onclick="socket.emit('roll')" style="background: #ff5722;">ğŸ² Ø§Ø±Ù…Ù Ø§Ù„Ù†Ø±Ø¯</button>
        <button onclick="socket.emit('correct')" style="background: #4caf50;">âœ… ØµØ­ÙŠØ­Ø©</button>
        <button onclick="socket.emit('wrong')" style="background: #f44336;">âŒ Ø®Ø§Ø·Ø¦Ø©</button>
        <button onclick="socket.emit('reset')" style="background: #ff9800;">ğŸ” Ø¥Ø¹Ø§Ø¯Ø©</button>
        <button onclick="location.href='index.html'" style="background: #607d8b;">â¬… Ø±Ø¬ÙˆØ¹</button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        socket.on("state", s => {
            if(s.contestName) document.getElementById("mainTitle").innerText = "ğŸ " + s.contestName;
            const board = document.getElementById("board");
            board.innerHTML = "";
            s.teams.forEach(t => {
                const isCurrent = s.current && s.current.id === t.id;
                const pos = (t.steps / 10) * 85; 
                board.innerHTML += `
                    <div class="track" style="${isCurrent ? 'border: 3px solid #ffeb3b; background:white;' : ''}">
                        <div class="team-name" style="${isCurrent ? 'background:#e91e63; color:white;' : ''}">${t.name}</div>
                        <div class="icon" style="bottom:${pos}%">${isCurrent ? 'ğŸ¦„' : 'ğŸš€'}</div>
                    </div>`;
            });
     
   });
socket.on("state", s => {
    if(s.contestName) document.getElementById("mainTitle").innerText = "ğŸ " + s.contestName;
    const board = document.getElementById("board");
    board.innerHTML = "";
    s.teams.forEach(t => {
        const isCurrent = s.current && s.current.id === t.id;
        // Ø±ÙØ¹Ù†Ø§ Ø§Ù„Ù†Ø³Ø¨Ø© Ø¥Ù„Ù‰ 90 Ù„ÙƒÙŠ ØªØµÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù„Ø¢Ø®Ø± Ø§Ù„Ù…Ø³Ø§Ø± ÙÙˆÙ‚
        const pos = (t.steps / 10) * 90; 
        
        board.innerHTML += `
            <div class="track" style="${isCurrent ? 'border: 3px solid #ffeb3b; background:white;' : ''}">
                <div class="finish-line">
                    <span class="finish-flag">ğŸ</span>
                </div>

                <div class="team-name" style="${isCurrent ? 'background:#e91e63; color:white;' : ''}">${t.name}</div>
                
                <div class="icon" style="bottom:${pos}%">
                    ${isCurrent ? 'ğŸ¦„' : 'ğŸš€'}
                </div>

                <div class="start-line">ğŸš©</div>
            </div>`;
    });
});


    socket.on("winner", name => {
    const overlay = document.getElementById("winnerOverlay");
    document.getElementById("winnerName").innerText = name;
    overlay.style.display = "flex"; // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ¨Ø±ÙŠÙƒØ§Øª
});
</script>

<div id="winnerOverlay">
    <h2>ğŸŠ Ø£Ù„Ù€Ù€Ù€Ù€Ù Ù…Ø¨Ø±ÙˆÙƒ Ù„Ù„ÙØ§Ø¦Ø² ğŸŠ</h2>
    <div id="winnerName">Ø§Ø³Ù… Ø§Ù„ÙØ±ÙŠÙ‚</div>
    <div class="confetti">âœ¨ğŸ¥³ğŸˆğŸ‰</div>
    <button onclick="location.reload()" style="margin-top:40px; background:#ff9800;">Ø¥ØºÙ„Ø§Ù‚ ÙˆØ¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
</div>
</body>
</html>
